<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Payment Gateway Link</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
  <!-- popup box start from here -->
<div id="popup_wrapper">
    <div class="box">
        <div class="text">*After you paid, you must come back here to submit the Ref/UTR No. (12 digits). Then your money is credited to your account.</div>
        <div class="image"><img src="utr_example.png" alt="image" width="100%"></div>
        <button onclick="document.querySelector('#popup_wrapper').style.display='none';">OK</button>
    </div>
</div>
                <!-- popup box end here -->

    <!-- Timer Display -->
    <div id="timer" style="text-align: center; font-size: 1.5rem; margin-top: 20px; color: red;">
        Time Left: 6:00
    </div>
    
                
                <!-- step 1 start from here -->
<section id="step_1">
    <!-- alert -->
    <div class="copyAlert">Text Copied!</div>
    <div class="-container">
        <div class="title"> Step 1 : Verify Your Name Or Amount Then Copy UPI ID </div>
        <div class="wrapper">
            <h5>Amount</h5>
            <div class="right_item">
                <span id="amount_input"></span>
                <button onclick="copyText('amount_input')">Copy</button>
            </div>
        </div>
        <hr>
        <div class="wrapper">
            <h5>Name</h5>
            <div class="right_item">
                <span id="name_input"></span>
                <button onclick="copyText('name_input')">Copy</button>
            </div>
        </div>
        <hr>
        <div class="wrapper">
            <h5>VPA/UPI</h5>
            <div class="right_item">
                <span id="vpa_input"></span>
                <button onclick="copyText('vpa_input')">Copy</button>
            </div>
        </div>
    </div>
</section>
                <!-- step 1 end here -->
 
  <!-- step 2 start from here -->
    <section id="step_2">
        <div class="errMsg" style="color: red; display: none;">Please input a valid 12-digit reference code</div>
        <div class="-container">
            <div class="title">Step 2: Enter Ref No. After Making The Payment</div>
            <form onsubmit="return valid_upi_form()">
                <input type="text" id="refCode" placeholder="UTR (UPI Ref. ID) must be 12 digits" required>
                <input type="submit" value="Submit UTR">
            </form>
        </div>
    </section>
   <!-- step 2 end here -->

    <footer>
        <h4>Safe and Faithful</h4>
    </footer>
</body>
</html>

   <!-- js codes start from here -->

<script>
  
let timerStarted = false;

    function startCountdown(remainingTime) {
        if (timerStarted) return; // Prevent multiple timers
        timerStarted = true;

        const timerElement = document.getElementById('timer');
        const interval = setInterval(() => {
            const minutes = Math.floor(remainingTime / 1000 / 60);
            const seconds = Math.floor((remainingTime / 1000) % 60);

            if (timerElement) {
                timerElement.innerText = `Time Left: ${minutes}:${seconds.toString().padStart(2, '0')}`;
            }

            if (remainingTime <= 0) {
                clearInterval(interval);
                showSessionExpiredMessage();
            }

            remainingTime -= 1000;
        }, 1000);
    }

    function showSessionExpiredMessage() {
        document.body.innerHTML = `
            <div style="text-align: center; margin-top: 50px;">
                <h1>Session Expired</h1>
                <p>You cannot access this page anymore. Please generate a new link to continue.</p>
                <img src="https://png.pngtree.com/png-clipart/20230806/original/pngtree-time-expired-ink-grungy-course-vector-picture-image_9915504.png"
                     alt="Time Expired" style="max-width: 100%; height: auto;">
            </div>
        `;
        // Optionally clear the unique key on expiration
        localStorage.removeItem("urlKey");
    }

    function validateUrlUsage() {
        const currentUrlKey = "uniqueKey"; // Replace this with a server-generated unique key
        const storedKey = localStorage.getItem("urlKey");

        if (storedKey === currentUrlKey) {
            // If the URL has been used, block access
            document.body.innerHTML = `
                <div style="text-align: center; margin-top: 50px;">
                    <h1>Access Denied</h1>
                    <p>This URL has already been used. Please generate a new link to access the page.</p>
                </div>
            `;
        } else {
            // Mark the URL as used
            localStorage.setItem("urlKey", currentUrlKey);
            startCountdown(300000); // Example 5-minute countdown
        }
    }

    window.addEventListener('load', () => {
        validateUrlUsage();
    });

    function copyText(element) {
        const copyText = document.getElementById(element).innerText;
        const copyAlert = document.querySelector("#step_1 .copyAlert");

        navigator.clipboard.writeText(copyText);
        copyAlert.classList.add("active");
        setTimeout(() => {
            copyAlert.classList.remove("active");
        }, 1500);
    }

    window.addEventListener('load', () => {
        const params = new URL(document.location).searchParams;
        const AMNT = params.get('amntInput');
        const NAME = params.get('nameInput');
        const VPA = params.get('vpaInput');

        document.getElementById("amount_input").innerHTML = AMNT || "";
        document.getElementById("name_input").innerHTML = NAME || "";
        document.getElementById("vpa_input").innerHTML = VPA || "";
    });

    function valid_upi_form() {
        const reference = document.getElementById("refCode").value;
        const countRef = reference.length;
        const err = document.querySelector("#step_3 .errMsg");

        if (countRef !== 12) {
            err.style.display = "block";
            setTimeout(() => {
                err.style.display = "none";
            }, 1500);
            return false;
        } else {
            document.body.innerHTML = `
                <div style="text-align: center; margin-top: 50px;">
                    <h1>UTR Submitted Successfully</h1>
                    <p>We Will Update Your Loan Immediately After Receiving The Recharge</p>
                </div>
            `;
            return false; // Prevent actual form submission
        }
    }
</script>
                <!-- js codes end here -->
                
